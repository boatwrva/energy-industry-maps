(this["webpackJsonpnew-app"]=this["webpackJsonpnew-app"]||[]).push([[0],{13:function(e,t,a){e.exports=a(22)},18:function(e,t,a){},21:function(e,t,a){},22:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(3),l=a.n(c),r=(a(18),a(4)),i=a(5),s=a(1),p=a(7),m=a(6),d=a(2),u=a.n(d),h={"Academia/Research":"#07a4bc","Accelerator/Incubator":"#c30",Biofuels:"#7cc908",Buildings:"#036",Chemistry:"#c94208","Circular Economy":"#5a8925",Construction:"#603e1e","Enabling Technology/Components":"#603e1e","Energy Systems/Management":"#40a22a",Engineering:"#603e1e","Environmental Remediation":"#89256e","Evaluation/Compliance":"#9e4e16",Finance:"#269e11","Generation/Transmission":"#f80",Geology:"#9e4e16",Hydrogen:"#2cf","IIoT/IoT":"#a92278",Lighting:"#f4f390",Manufacturing:"#7b16ce",Materials:"#7b16ce",Media:"#d11265","Mobility as a Service":"#b75e35",Nuclear:"#f0f","Oil and Gas":"#ce3b16",Policy:"#660","Professional Services":"#164d82","Security/Cybersecurity":"#2c86f4",Sensors:"#dd4465",Solar:"#fce119",Storage:"#093","Sustainable Agriculture":"#898925","Thermal Energy":"#bc6d4b","Utility/Grid":"#f4a41a","Wave/Water/Hydro":"#20dbdb",Wind:"#167d7f"},g=Object.keys(h),y=Object.entries(h).flat().concat(["#ccc"]),f=function(e){return e.toLowerCase().replace(/[/ ]/g,"-")},C=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={displayCategories:!0},n.handleSelectCategory=n.handleSelectCategory.bind(Object(s.a)(n)),n.selectAll=n.selectAll.bind(Object(s.a)(n)),n.deselectAll=n.deselectAll.bind(Object(s.a)(n)),n.toggleDisplayCategoryList=n.toggleDisplayCategoryList.bind(Object(s.a)(n)),n}return Object(i.a)(a,[{key:"selectAll",value:function(){this.props.onSelectAllCategories()}},{key:"deselectAll",value:function(){this.props.onDeselectAllCategories()}},{key:"handleSelectCategory",value:function(e){this.props.onToggleCategory(e)}},{key:"toggleDisplayCategoryList",value:function(){var e=this.state.displayCategories;this.setState({displayCategories:!e})}},{key:"render",value:function(){var e=this,t=g.map((function(t){var a=f(t),n="".concat(a,"-checkbox"),c=e.props.selectedCategories.has(a);return o.a.createElement("tr",{key:a},o.a.createElement("td",null,o.a.createElement("input",{type:"checkbox",id:n,name:a,checked:c,className:"category-filter-checkbox",onChange:e.handleSelectCategory})),o.a.createElement("td",null,o.a.createElement("i",{className:"category-legend",style:{background:h[t]}})),o.a.createElement("td",null,o.a.createElement("label",{htmlFor:n},t)))}));return o.a.createElement("div",{id:"company-filter",className:this.state.displayCategories?null:"hidden"},o.a.createElement("button",{id:"filter-toggle",onClick:this.toggleDisplayCategoryList},o.a.createElement("div",{className:"flex-row"},o.a.createElement("div",{className:"flex-grow"},o.a.createElement("span",{className:"header"},"Filter by category")),o.a.createElement("div",{className:"hamburger-menu"},o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null)))),o.a.createElement("div",{className:"content"},o.a.createElement("div",null,o.a.createElement("button",{id:"select-all",className:"select-all",onClick:this.selectAll},"Select all"),o.a.createElement("button",{id:"select-none",className:"select-all",onClick:this.deselectAll},"Clear all"),o.a.createElement("table",{id:"categories"},o.a.createElement("tbody",null,t)))))}}]),a}(o.a.Component),b=a(12),v=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={option:""},n.handleChange=n.handleChange.bind(Object(s.a)(n)),n}return Object(i.a)(a,[{key:"handleChange",value:function(e){this.setState({option:e}),this.props.onSelectCompany(e.value)}},{key:"render",value:function(){var e=[];this.props.companies&&(e=this.props.companies.map((function(e){return e.properties.company})).map((function(e){return{value:e,label:e}})));return o.a.createElement("div",{id:"place-search"},o.a.createElement(b.a,{options:e,placeholder:"Search...",onChange:this.handleChange,value:this.state.option}))}}]),a}(o.a.Component);a(21);var E="energy-companies-point-layer";function S(e){var t=new Set(e.features.map((function(e){return e.properties.tax1})));return Object.values(Array.from(t)).sort()}u.a.accessToken="pk.eyJ1IjoiZW5lcmd5c29jaWV0eW1hcHMiLCJhIjoiY2s4dWJxZXo1MDlmcTNtcXFyYWVuYTlzdCJ9.YS__mAp13-uA_yQlRcOYQw";var k=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={center:[-121,36.5],zoom:6,minZoom:6,companiesGeojson:{},selectedCategories:new Set},n.handleToggleCategory=n.handleToggleCategory.bind(Object(s.a)(n)),n.handleSelectAllCategories=n.handleSelectAllCategories.bind(Object(s.a)(n)),n.handleDeselectAllCategories=n.handleDeselectAllCategories.bind(Object(s.a)(n)),n.handleSelectCompany=n.handleSelectCompany.bind(Object(s.a)(n)),n.displayPopup=n.displayPopup.bind(Object(s.a)(n)),n}return Object(i.a)(a,[{key:"displayPopup",value:function(e){var t=e.geometry.coordinates.slice(),a=document.getElementsByClassName("mapboxgl-popup");a[0]&&a[0].remove(),new u.a.Popup({}).setLngLat(t).setHTML(function(e){var t=["tax1","tax2","tax3"].map((function(t){return e[t]})).filter((function(e){return e})).join(" | ");return'\n    <div class="popup">\n      <h3 class="company-name">'.concat(e.company,'</h3>\n      <span class="category-info">').concat(t,'</span><br />\n      <span class="city-info">').concat(e.city,"</span><br />\n      <span><a href=").concat(e.website,' target="blank">').concat(e.website,"</a></span>\n    </div>")}(e.properties)).setMaxWidth("40vw").addTo(this.map)}},{key:"componentDidMount",value:function(){var e=this;this.map=new u.a.Map({container:this.mapContainer,style:"mapbox://styles/mapbox/dark-v10",center:this.state.center,zoom:this.state.zoom,minZoom:this.state.minZoom}),this.map.on("move",(function(){e.setState({lng:e.map.getCenter().lng.toFixed(4),lat:e.map.getCenter().lat.toFixed(4),zoom:e.map.getZoom().toFixed(2)})})),this.map.on("load",(function(){e.map.addControl(new u.a.FullscreenControl,"bottom-left"),e.map.addControl(new u.a.NavigationControl,"bottom-left"),function(){var e="".concat("https://api.mapbox.com/datasets/v1","/").concat("energysocietymaps","/").concat("ck901ssdl1sxn2mmnj56s9ibm","/features?access_token=").concat(u.a.accessToken);return fetch(e).then((function(e){return e.text()})).then((function(e){return JSON.parse(e)})).then((function(e){return e.features.forEach((function(e){e.properties={company:e.properties.company,city:e.properties.city,tax1:e.properties.tax1,tax2:e.properties.tax2,tax3:e.properties.tax3,website:e.properties.website},["tax1","tax2","tax3"].forEach((function(t){var a="".concat(t,"sanitized");e.properties[a]=f(e.properties[t])}))})),e}))}().then((function(t){e.setState({companiesGeojson:t,categories:S(t)}),e.handleSelectAllCategories(),e.map.addSource("companies",{type:"geojson",data:t}),e.map.addLayer({id:E,type:"circle",source:"companies",paint:{"circle-radius":{stops:[[7,5],[14,12],[20,50]]},"circle-opacity":.85,"circle-color":["match",["get","tax1"]].concat(y),"circle-stroke-color":"#fff","circle-stroke-width":.4}}),e.map.on("mouseenter",E,(function(t){e.map.getCanvas().style.cursor="pointer"})),e.map.on("mouseleave",E,(function(){e.map.getCanvas().style.cursor=""})),e.map.on("click",E,(function(t){return e.displayPopup(t.features[0])}))})),e.map.flyTo({center:[-122.21,37.65],zoom:8,speed:.5})}))}},{key:"handleToggleCategory",value:function(e){var t=this.state.selectedCategories;t.has(e.target.name)?t.delete(e.target.name):t.add(e.target.name),this.setState({selectedCategories:t})}},{key:"handleSelectAllCategories",value:function(){var e=g.map(f);this.setState({selectedCategories:new Set(e)})}},{key:"handleDeselectAllCategories",value:function(){this.setState({selectedCategories:new Set})}},{key:"handleSelectCompany",value:function(e){var t=this.state.companiesGeojson.features.find((function(t){return t.properties.company===e}));this.displayPopup(t),this.map.flyTo({center:t.geometry.coordinates,zoom:14})}},{key:"componentDidUpdate",value:function(){if(this.map.getLayer(E)){var e=["any"],t=this.state.selectedCategories;[1,2,3].forEach((function(a){var n=["in","tax".concat(a,"sanitized")];t.forEach((function(e){return n.push(e)})),e.push(n)})),this.map.setFilter(E,e)}}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{id:"app-container"},o.a.createElement("div",{ref:function(t){return e.mapContainer=t},id:"map-container"}),o.a.createElement("div",{id:"map-overlay"},o.a.createElement("div",{id:"title-and-search"},o.a.createElement("div",{id:"map-title"},"Silicon Valley Energy Ecosystem, 2019"),o.a.createElement(v,{companies:this.state.companiesGeojson.features,onSelectCompany:this.handleSelectCompany})),o.a.createElement(C,{selectedCategories:this.state.selectedCategories,onSelectAllCategories:this.handleSelectAllCategories,onDeselectAllCategories:this.handleDeselectAllCategories,onToggleCategory:this.handleToggleCategory})))}}]),a}(o.a.Component);l.a.render(o.a.createElement(k,null),document.getElementById("root"))}},[[13,1,2]]]);
//# sourceMappingURL=main.f03176dc.chunk.js.map