(this["webpackJsonpnew-app"]=this["webpackJsonpnew-app"]||[]).push([[0],{11:function(e,t,a){e.exports=a(24)},16:function(e,t,a){},23:function(e,t,a){},24:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(8),c=a.n(o),i=(a(16),a(3)),r=a(4),l=a(1),u=a(6),p=a(5),m=a(2),d=a.n(m),h=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={query:"",hasFocus:!1,searchResults:[]},n.getCompanies=n.getCompanies.bind(Object(l.a)(n)),n.shouldDisplaySuggestions=n.shouldDisplaySuggestions.bind(Object(l.a)(n)),n.setHasFocus=n.setHasFocus.bind(Object(l.a)(n)),n.handleResultSelection=n.handleResultSelection.bind(Object(l.a)(n)),n.handleInputChange=n.handleInputChange.bind(Object(l.a)(n)),n}return Object(r.a)(a,[{key:"getCompanies",value:function(){return this.props.companies?this.props.companies.map((function(e){return e.properties.company})):[]}},{key:"shouldDisplaySuggestions",value:function(){return this.state.hasFocus&&this.state.searchResults.length>0}},{key:"setHasFocus",value:function(e){this.setState({hasFocus:e})}},{key:"handleResultSelection",value:function(e){this.props.onSelectCompany(e),this.setState({query:e,searchResults:[]})}},{key:"handleInputChange",value:function(){var e=this.searchInput.value;this.setState({query:e}),e.length>=2?this.setState({searchResults:this.getCompanies().filter((function(t){return t.toLowerCase().includes(e.toLowerCase())}))}):this.setState({searchResults:[]})}},{key:"render",value:function(){var e=this,t=this.state.searchResults.map((function(t){return s.a.createElement("li",{key:t,onMouseDown:function(){return e.handleResultSelection(t)}},t)}));return s.a.createElement("div",{className:"omnibox"},s.a.createElement("button",{className:"omnibox-burger-menu",onClick:this.props.onOpenSettingsPane,title:"Menu","aria-label":"Menu"},s.a.createElement("span",null,s.a.createElement("span",{className:"omnibox-burger-bar omnibox-burger-bar-top","aria-hidden":"true"}),s.a.createElement("span",{className:"omnibox-burger-bar omnibox-burger-bar-middle","aria-hidden":"true"}),s.a.createElement("span",{className:"omnibox-burger-bar omnibox-burger-bar-bottom","aria-hidden":"true"}))),s.a.createElement("div",{className:"omnibox-search-input-container"},s.a.createElement("input",{type:"text",className:"omnibox-search-input",id:"omnibox-search-input",ref:function(t){return e.searchInput=t},onChange:this.handleInputChange,value:this.state.query,onFocus:function(){return e.setHasFocus(!0)},onBlur:function(){return e.setHasFocus(!1)},placeholder:"Search..."})),s.a.createElement("div",{className:"omnibox-search-suggestions-container",style:{display:this.shouldDisplaySuggestions()?"block":"none"}},s.a.createElement("ul",{className:"omnibox-search-suggestions"},t)),s.a.createElement("button",{className:"omnibox-search-button",title:"Search","aria-label":"Search",onClick:function(){return document.getElementById("omnibox-search-input").focus()}},s.a.createElement("div",{className:"magnifying-glass","aria-hidden":"true"},"\u26b2")))}}]),a}(s.a.Component),g=a(10),b=a.n(g),y={"Academia/Research":"#07a4bc","Accelerator/Incubator":"#c30",Biofuels:"#7cc908",Buildings:"#036",Chemistry:"#c94208","Circular Economy":"#5a8925",Construction:"#603e1e","Enabling Technology/Components":"#603e1e","Energy Systems/Management":"#40a22a",Engineering:"#603e1e","Environmental Remediation":"#89256e","Evaluation/Compliance":"#9e4e16",Finance:"#269e11","Generation/Transmission":"#f80",Geology:"#9e4e16",Hydrogen:"#2cf","IIoT/IoT":"#a92278",Lighting:"#f4f390",Manufacturing:"#7b16ce",Materials:"#7b16ce",Media:"#d11265","Mobility as a Service":"#b75e35",Nuclear:"#f0f","Oil and Gas":"#ce3b16",Policy:"#660","Professional Services":"#164d82","Security/Cybersecurity":"#2c86f4",Sensors:"#dd4465",Solar:"#fce119",Storage:"#093","Sustainable Agriculture":"#898925","Thermal Energy":"#bc6d4b","Utility/Grid":"#f4a41a","Wave/Water/Hydro":"#20dbdb",Wind:"#167d7f"},f=Object.keys(y),v=Object.entries(y).flat().concat(["#ccc"]),C=function(e){return e.toLowerCase().replace(/[/ ]/g,"-")},S=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onToggleOpen=n.onToggleOpen.bind(Object(l.a)(n)),n.handleSelectCategory=n.handleSelectCategory.bind(Object(l.a)(n)),n.selectAll=n.selectAll.bind(Object(l.a)(n)),n.deselectAll=n.deselectAll.bind(Object(l.a)(n)),n}return Object(r.a)(a,[{key:"onToggleOpen",value:function(e){this.props.onToggleOpen(e.isOpen)}},{key:"handleSelectCategory",value:function(e){this.props.onToggleCategory(e)}},{key:"selectAll",value:function(){this.props.onSelectAllCategories()}},{key:"deselectAll",value:function(){this.props.onDeselectAllCategories()}},{key:"render",value:function(){var e=this,t=f.map((function(t){var a=C(t),n="".concat(a,"-checkbox"),o=e.props.selectedCategories.has(a);return s.a.createElement("tr",{key:a},s.a.createElement("td",null,s.a.createElement("input",{type:"checkbox",id:n,name:a,checked:o,className:"category-filter-checkbox",onChange:e.handleSelectCategory})),s.a.createElement("td",null,s.a.createElement("i",{className:"category-legend",style:{background:y[t]}})),s.a.createElement("td",null,s.a.createElement("label",{htmlFor:n},t)))}));return s.a.createElement("div",null,s.a.createElement(b.a,{isOpen:this.props.settingsPaneOpen,onStateChange:this.onToggleOpen,styles:{sidebar:{background:"white"}}},s.a.createElement("div",{className:"map-settings-pane"},s.a.createElement("div",{className:"map-settings-pane-section-header"},s.a.createElement("span",null,"Filter by Category"),s.a.createElement("div",{className:"bm-cross-button"})),s.a.createElement("div",{className:"map-settings-pane-content"},s.a.createElement("button",{id:"select-all",className:"select-all",onClick:this.selectAll},"Select all"),s.a.createElement("button",{id:"select-none",className:"select-all",onClick:this.deselectAll},"Clear all"),s.a.createElement("table",{id:"categories"},s.a.createElement("tbody",null,t))))))}}]),a}(s.a.Component);a(23);var E="energy-companies-point-layer";function O(e){var t=new Set(e.features.map((function(e){return e.properties.tax1})));return Object.values(Array.from(t)).sort()}d.a.accessToken="pk.eyJ1IjoiZW5lcmd5c29jaWV0eW1hcHMiLCJhIjoiY2s4dWJxZXo1MDlmcTNtcXFyYWVuYTlzdCJ9.YS__mAp13-uA_yQlRcOYQw";var k=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={center:[-121,36.5],zoom:6,minZoom:6,companiesGeojson:{},selectedCategories:new Set,settingsPaneOpen:!1,mapTitle:"Silicon Valley Energy Ecosystem, 2019"},n.handleToggleCategory=n.handleToggleCategory.bind(Object(l.a)(n)),n.handleSelectAllCategories=n.handleSelectAllCategories.bind(Object(l.a)(n)),n.handleDeselectAllCategories=n.handleDeselectAllCategories.bind(Object(l.a)(n)),n.handleSelectCompany=n.handleSelectCompany.bind(Object(l.a)(n)),n.handleToggleSettingsPane=n.handleToggleSettingsPane.bind(Object(l.a)(n)),n.displayPopup=n.displayPopup.bind(Object(l.a)(n)),n}return Object(r.a)(a,[{key:"displayPopup",value:function(e){var t=e.geometry.coordinates.slice(),a=document.getElementsByClassName("mapboxgl-popup");a[0]&&a[0].remove(),new d.a.Popup({}).setLngLat(t).setHTML(function(e){var t=["tax1","tax2","tax3"].map((function(t){return e[t]})).filter((function(e){return e})).join(" | ");return'\n    <div class="popup">\n      <h3 class="company-name">'.concat(e.company,'</h3>\n      <span class="category-info">').concat(t,'</span><br />\n      <span class="city-info">').concat(e.city,"</span><br />\n      <span><a href=").concat(e.website,' target="blank">').concat(e.website,"</a></span>\n    </div>")}(e.properties)).setMaxWidth("40vw").addTo(this.map)}},{key:"componentDidMount",value:function(){var e=this;this.map=new d.a.Map({container:this.mapContainer,style:"mapbox://styles/mapbox/dark-v10",center:this.state.center,zoom:this.state.zoom,minZoom:this.state.minZoom}),this.map.on("move",(function(){e.setState({lng:e.map.getCenter().lng.toFixed(4),lat:e.map.getCenter().lat.toFixed(4),zoom:e.map.getZoom().toFixed(2)})}));var t=function(){var e="".concat("https://api.mapbox.com/datasets/v1","/").concat("energysocietymaps","/").concat("ck901ssdl1sxn2mmnj56s9ibm","/features?access_token=").concat(d.a.accessToken);return fetch(e).then((function(e){return e.text()})).then((function(e){return JSON.parse(e)})).then((function(e){return e.features.forEach((function(e){e.properties={company:e.properties.company,city:e.properties.city,tax1:e.properties.tax1,tax2:e.properties.tax2,tax3:e.properties.tax3,website:e.properties.website},["tax1","tax2","tax3"].forEach((function(t){var a="".concat(t,"sanitized");e.properties[a]=C(e.properties[t])}))})),e}))}().then((function(t){return e.setState({companiesGeojson:t,categories:O(t)}),e.handleSelectAllCategories(),t}));this.map.on("load",(function(){e.map.addControl(new d.a.FullscreenControl,"bottom-right"),e.map.addControl(new d.a.NavigationControl,"bottom-right"),t.then((function(t){e.map.addSource("companies",{type:"geojson",data:t}),e.map.addLayer({id:E,type:"circle",source:"companies",paint:{"circle-radius":{stops:[[7,5],[14,12],[20,50]]},"circle-opacity":.85,"circle-color":["match",["get","tax1"]].concat(v),"circle-stroke-color":"#fff","circle-stroke-width":.4}}),e.map.on("mouseenter",E,(function(t){e.map.getCanvas().style.cursor="pointer"})),e.map.on("mouseleave",E,(function(){e.map.getCanvas().style.cursor=""})),e.map.on("click",E,(function(t){return e.displayPopup(t.features[0])})),e.map.flyTo({center:[-122.21,37.65],zoom:8,speed:.5})}))}))}},{key:"handleToggleCategory",value:function(e){var t=this.state.selectedCategories;t.has(e.target.name)?t.delete(e.target.name):t.add(e.target.name),this.setState({selectedCategories:t})}},{key:"handleSelectAllCategories",value:function(){var e=f.map(C);this.setState({selectedCategories:new Set(e)})}},{key:"handleDeselectAllCategories",value:function(){this.setState({selectedCategories:new Set})}},{key:"handleSelectCompany",value:function(e){var t=this.state.companiesGeojson.features.find((function(t){return t.properties.company===e}));this.displayPopup(t),this.map.flyTo({center:t.geometry.coordinates,zoom:14})}},{key:"handleToggleSettingsPane",value:function(e){this.setState({settingsPaneOpen:e})}},{key:"componentDidUpdate",value:function(){if(this.map.getLayer(E)){var e=["any"],t=this.state.selectedCategories;[1,2,3].forEach((function(a){var n=["in","tax".concat(a,"sanitized")];t.forEach((function(e){return n.push(e)})),e.push(n)})),this.map.setFilter(E,e)}}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{id:"app-container"},s.a.createElement(S,{onToggleOpen:this.handleToggleSettingsPane,settingsPaneOpen:this.state.settingsPaneOpen,selectedCategories:this.state.selectedCategories,onSelectAllCategories:this.handleSelectAllCategories,onDeselectAllCategories:this.handleDeselectAllCategories,onToggleCategory:this.handleToggleCategory}),s.a.createElement("div",{ref:function(t){return e.mapContainer=t},id:"map-container"}),s.a.createElement("div",{className:"map-overlay"},s.a.createElement("div",{className:"map-title-and-search"},s.a.createElement("div",{className:"map-title"},this.state.mapTitle),s.a.createElement(h,{companies:this.state.companiesGeojson.features,onSelectCompany:this.handleSelectCompany,onOpenSettingsPane:function(){return e.handleToggleSettingsPane(!0)}}))))}}]),a}(s.a.Component);c.a.render(s.a.createElement(k,null),document.getElementById("root"))}},[[11,1,2]]]);
//# sourceMappingURL=main.f276f9fc.chunk.js.map